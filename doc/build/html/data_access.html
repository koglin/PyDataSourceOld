

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Data Access Overview &mdash; PyDataSource 0.0.0 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="genindex.html"/>
        <link rel="search" title="Search" href="search.html"/>
    <link rel="top" title="PyDataSource 0.0.0 documentation" href="index.html"/>
        <link rel="next" title="Data Processing" href="data_processing.html"/>
        <link rel="prev" title="Welcome to PyDataSource’s documentation!" href="index.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> PyDataSource
          

          
          </a>

          
            
            
              <div class="version">
                0.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Data Access Overview</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#analysis-environment">Analysis Environment</a></li>
<li class="toctree-l2"><a class="reference internal" href="#data-source">Data Source</a></li>
<li class="toctree-l2"><a class="reference internal" href="#calibrated-area-detector">Calibrated Area Detector</a></li>
<li class="toctree-l2"><a class="reference internal" href="#event-iteration">Event Iteration</a></li>
<li class="toctree-l2"><a class="reference internal" href="#event-codes">Event Codes</a></li>
<li class="toctree-l2"><a class="reference internal" href="#beamline-data">Beamline Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="#epics-data">Epics Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="#waveform-detectors">Waveform Detectors</a></li>
<li class="toctree-l2"><a class="reference internal" href="#anlyzing-scans">Anlyzing Scans</a></li>
<li class="toctree-l2"><a class="reference internal" href="#reloading-datasource">Reloading DataSource</a></li>
<li class="toctree-l2"><a class="reference internal" href="#jump-quickly-to-specific-event">Jump Quickly to Specific Event</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="data_processing.html">Data Processing</a></li>
<li class="toctree-l1"><a class="reference internal" href="xarray.html">Data Structures</a></li>
<li class="toctree-l1"><a class="reference internal" href="api.html">PyDatSource API</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">PyDataSource</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Data Access Overview</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/data_access.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="data-access-overview">
<span id="data-access"></span><h1>Data Access Overview<a class="headerlink" href="#data-access-overview" title="Permalink to this headline">¶</a></h1>
<p>The <strong>PyDataSource</strong> package provides access to LCLS event data by wrapping the psana &#8220;Detector&#8221; interface.  This page provides a quick introduction to basic event data access.  See other pages and the API section for futher details and options.</p>
<div class="section" id="analysis-environment">
<h2>Analysis Environment<a class="headerlink" href="#analysis-environment" title="Permalink to this headline">¶</a></h2>
<p>Use the following environment Setup from psana machine.  Start ipython with the &#8211;pylab option (or if youy prefer import numpy and matplotlib as needed).</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>.  /reg/g/psdm/etc/ana_env.sh
<span class="nb">source</span> conda_setup
ipython --pylab
</pre></div>
</div>
</div>
<div class="section" id="data-source">
<h2>Data Source<a class="headerlink" href="#data-source" title="Permalink to this headline">¶</a></h2>
<p>Use run and exp keywords to access your data using <strong>PyDataSource.DataSource</strong>.</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [1]: </span><span class="kn">import</span> <span class="nn">PyDataSource</span>

<span class="gp">In [2]: </span><span class="n">ds</span> <span class="o">=</span> <span class="n">PyDataSource</span><span class="o">.</span><span class="n">DataSource</span><span class="p">(</span><span class="n">exp</span><span class="o">=</span><span class="s1">&#39;xpptut15&#39;</span><span class="p">,</span><span class="n">run</span><span class="o">=</span><span class="mi">54</span><span class="p">)</span>

<span class="gp">In [3]: </span><span class="n">ds</span><span class="o">.</span><span class="n">configData</span>
<span class="gh">Out[3]: </span><span class="go">&lt; ConfigData: exp=mfx12616:run=45:smd &gt;</span>
<span class="go">*Detectors in group 0 are &quot;BLD&quot; data recorded at 120 Hz on event code 40</span>
<span class="go">*Detectors listed as Controls are controls devices with unknown event code (but likely 40).</span>
<span class="go">Alias                     Group          Rate  Code  Pol. Delay [s]    Width [s]    Source</span>
<span class="gt">------------------------------------------------------------------------------------------------------------------------</span>
<span class="n">Acqiris</span>                       <span class="mi">1</span>                 <span class="mi">198</span>   <span class="n">Pos</span> <span class="mf">0.000147630</span>  <span class="mf">0.000010000</span>  <span class="n">DetInfo</span><span class="p">(</span><span class="n">MfxEndstation</span><span class="o">.</span><span class="mi">0</span><span class="p">:</span><span class="n">Acqiris</span><span class="o">.</span><span class="mi">0</span><span class="p">)</span>
<span class="n">BeamMonitor</span>                   <span class="mi">1</span>                 <span class="mi">198</span>                                 <span class="n">DetInfo</span><span class="p">(</span><span class="n">MfxEndstation</span><span class="o">.</span><span class="mi">0</span><span class="p">:</span><span class="n">Wave8</span><span class="o">.</span><span class="mi">0</span><span class="p">)</span>
<span class="n">EBeam</span>                         <span class="mi">1</span>                                                     <span class="n">BldInfo</span><span class="p">(</span><span class="n">EBeam</span><span class="p">)</span>
<span class="n">FEEGasDetEnergy</span>               <span class="mi">1</span>                                                     <span class="n">BldInfo</span><span class="p">(</span><span class="n">FEEGasDetEnergy</span><span class="p">)</span>
<span class="n">FEE_Spec</span>                      <span class="mi">1</span>                                                     <span class="n">BldInfo</span><span class="p">(</span><span class="n">FEE</span><span class="o">-</span><span class="n">SPEC0</span><span class="p">)</span>
<span class="n">PhaseCavity</span>                   <span class="mi">1</span>                                                     <span class="n">BldInfo</span><span class="p">(</span><span class="n">PhaseCavity</span><span class="p">)</span>
<span class="n">Rayonix</span>                       <span class="mi">1</span>                 <span class="mi">198</span>   <span class="n">Neg</span> <span class="mf">0.002998336</span>  <span class="mf">0.000500000</span>  <span class="n">DetInfo</span><span class="p">(</span><span class="n">MfxEndstation</span><span class="o">.</span><span class="mi">0</span><span class="p">:</span><span class="n">Rayonix</span><span class="o">.</span><span class="mi">0</span><span class="p">)</span>
<span class="o">&lt;</span> <span class="n">ConfigData</span><span class="p">:</span> <span class="n">exp</span><span class="o">=</span><span class="n">mfx12616</span><span class="p">:</span><span class="n">run</span><span class="o">=</span><span class="mi">45</span><span class="p">:</span><span class="n">smd</span> <span class="o">&gt;</span>

<span class="gp">In [4]: </span><span class="n">evt</span>  <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">events</span><span class="o">.</span><span class="n">next</span><span class="p">()</span>
</pre></div>
</div>
<p>Press tab to see detectors in event (according to aliases defined in daq).</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [5]: </span><span class="n">evt</span><span class="o">.</span>
<span class="go">         evt.cspad           evt.Evr             evt.keys            evt.PhaseCavity     evt.XppSb3_Ipm</span>
<span class="go">         evt.EBeam           evt.FEEGasDetEnergy evt.L3T             evt.XppEnds_Ipm0    evt.yag2</span>
<span class="go">         evt.EventId         evt.get             evt.next            evt.XppSb2_Ipm      evt.yag_lom</span>
</pre></div>
</div>
</div>
<div class="section" id="calibrated-area-detector">
<h2>Calibrated Area Detector<a class="headerlink" href="#calibrated-area-detector" title="Permalink to this headline">¶</a></h2>
<dl class="docutils">
<dt>For complex detectors such as the cspad, the detector object gives access to the raw, calibrated and reconstructed images.</dt>
<dd><ul class="first last simple">
<li>raw:    raw uncorrected data (3D array)</li>
<li>calib:  calibrated &#8220;unassembled data&#8221; (3D array, pedestal and common mode corrected, no geometry applied)</li>
<li>image:  &#8220;assembled images&#8221; (2D array, geometry applied).</li>
</ul>
</dd>
</dl>
<p>Tab on the evt.cspad object to see the attributes available and use the show_info method to print a summary table.</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [36]: </span><span class="n">evt</span><span class="o">.</span><span class="n">cspad</span><span class="o">.</span>
<span class="go">            evt.cspad.add        evt.cspad.epicsData  evt.cspad.L3T        evt.cspad.set_cmpars</span>
<span class="go">            evt.cspad.calib      evt.cspad.EventId    evt.cspad.monitor    evt.cspad.shape</span>
<span class="go">            evt.cspad.calibData  evt.cspad.Evr        evt.cspad.next       evt.cspad.show_all   &gt;</span>
<span class="go">            evt.cspad.configData evt.cspad.evtData    evt.cspad.psplots    evt.cspad.show_info</span>
<span class="go">            evt.cspad.detector   evt.cspad.image      evt.cspad.raw        evt.cspad.size</span>

<span class="gp">In [35]: </span><span class="n">evt</span><span class="o">.</span><span class="n">cspad</span><span class="o">.</span><span class="n">show_info</span><span class="p">()</span>
<span class="gh">Out[35]:</span>
<span class="gt">--------------------------------------------------------------------------------</span>
<span class="n">cspad</span> <span class="n">xpptut15</span><span class="p">,</span> <span class="n">Run</span> <span class="mi">54</span><span class="p">,</span> <span class="n">Step</span> <span class="mi">0</span><span class="p">,</span> <span class="n">Event</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">11</span><span class="p">:</span><span class="mi">37</span><span class="p">:</span><span class="mf">12.4517</span><span class="p">,</span> <span class="p">[</span><span class="mi">140</span><span class="p">,</span> <span class="mi">141</span><span class="p">,</span> <span class="mi">41</span><span class="p">,</span> <span class="mi">40</span><span class="p">]</span>
<span class="gt">--------------------------------------------------------------------------------</span>
<span class="n">calib</span>                 <span class="o">&lt;</span><span class="mf">0.01065</span><span class="o">&gt;</span> <span class="n">ADU</span>     <span class="n">Calibrated</span> <span class="n">data</span>
<span class="n">image</span>                <span class="o">&lt;</span><span class="mf">0.008139</span><span class="o">&gt;</span> <span class="n">ADU</span>     <span class="n">Reconstruced</span> <span class="mi">2</span><span class="n">D</span> <span class="n">image</span> <span class="kn">from</span> <span class="nn">calibStore</span> <span class="nn">geometry</span>
<span class="n">raw</span>                  <span class="o">&lt;</span><span class="mf">1.57e+03</span><span class="o">&gt;</span> <span class="n">ADU</span>     <span class="n">Raw</span> <span class="n">data</span>
<span class="n">shape</span>              <span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="mi">185</span><span class="p">,</span> <span class="mi">388</span><span class="p">)</span>         <span class="n">Shape</span> <span class="n">of</span> <span class="n">raw</span> <span class="n">data</span> <span class="n">array</span>
<span class="n">size</span>                    <span class="mi">2296960</span>         <span class="n">Total</span> <span class="n">size</span> <span class="n">of</span> <span class="n">raw</span> <span class="n">data</span>
</pre></div>
</div>
<p>See example below of plotting an image with the matplotlib plotting library</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">PyDataSource</span>

<span class="n">ds</span> <span class="o">=</span> <span class="n">PyDataSource</span><span class="o">.</span><span class="n">DataSource</span><span class="p">(</span><span class="n">exp</span><span class="o">=</span><span class="s1">&#39;xpptut15&#39;</span><span class="p">,</span><span class="n">run</span><span class="o">=</span><span class="mi">54</span><span class="p">)</span>

<span class="n">evt</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">events</span><span class="o">.</span><span class="n">next</span><span class="p">()</span>

<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">evt</span><span class="o">.</span><span class="n">cspad</span><span class="o">.</span><span class="n">image</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=-</span><span class="mi">2</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>(<a class="reference external" href="./examples/cspad.py">Source code</a>, <a class="reference external" href="./examples/cspad.png">png</a>, <a class="reference external" href="./examples/cspad.hires.png">hires.png</a>, <a class="reference external" href="./examples/cspad.pdf">pdf</a>)</p>
<div class="figure">
<img alt="_images/cspad.png" src="_images/cspad.png" />
</div>
</div>
<div class="section" id="event-iteration">
<h2>Event Iteration<a class="headerlink" href="#event-iteration" title="Permalink to this headline">¶</a></h2>
<p>One can iterate events from the ds.events object, the evt object, or a detector object.  Each of these are python iterators.</p>
<p>The representation of each of these provides details of the event including the event codes present.</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [6]: </span><span class="n">ds</span><span class="o">.</span><span class="n">events</span><span class="o">.</span><span class="n">next</span><span class="p">()</span>
<span class="gh">Out[6]: </span><span class="go">&lt; EvtDetectors: xpptut15, Run 54, Step 0, Event 1, 11:37:12.4599, [140, 40] &gt;</span>

<span class="gp">In [7]: </span><span class="n">evt</span><span class="o">.</span><span class="n">next</span><span class="p">()</span>
<span class="gh">Out[7]: </span><span class="go">&lt; EvtDetectors: xpptut15, Run 54, Step 0, Event 2, 11:37:12.4683, [140, 141, 142, 143, 144, 41, 42, 43, 44, 40] &gt;</span>

<span class="gp">In [8]: </span><span class="n">evt</span><span class="o">.</span><span class="n">cspad</span><span class="o">.</span><span class="n">next</span><span class="p">()</span>
<span class="gh">Out[8]: </span><span class="go">&lt; Detector: cspad xpptut15, Run 54, Step 0, Event 3, 11:37:12.4768, [140, 40] &gt;</span>

<span class="gp">In [9]: </span><span class="k">for</span> <span class="n">evt</span> <span class="ow">in</span> <span class="n">ds</span><span class="o">.</span><span class="n">events</span><span class="p">:</span>
<span class="go">    ...:     print evt</span>
<span class="go">    ...:     if ds._ievent == 6:</span>
<span class="go">    ...:         break</span>
<span class="go">    ...:</span>
<span class="go">xpptut15, Run 54, Step 0, Event 4, 11:37:12.4849, [140, 141, 41, 40]</span>
<span class="go">xpptut15, Run 54, Step 0, Event 5, 11:37:12.4934, [140, 40]</span>
<span class="go">xpptut15, Run 54, Step 0, Event 6, 11:37:12.5019, [140, 141, 142, 41, 42, 40]</span>
</pre></div>
</div>
</div>
<div class="section" id="event-codes">
<h2>Event Codes<a class="headerlink" href="#event-codes" title="Permalink to this headline">¶</a></h2>
<p>To check if an event codes is present:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [11]: </span><span class="n">evt</span><span class="o">.</span><span class="n">Evr</span><span class="o">.</span><span class="n">present</span><span class="p">(</span><span class="mi">40</span><span class="p">)</span>
<span class="gh">Out[11]: </span><span class="go">True</span>

<span class="gp">In [12]: </span><span class="n">evt</span><span class="o">.</span><span class="n">Evr</span><span class="o">.</span><span class="n">present</span><span class="p">(</span><span class="mi">41</span><span class="p">)</span>
<span class="gh">Out[12]: </span><span class="go">False</span>
</pre></div>
</div>
</div>
<div class="section" id="beamline-data">
<h2>Beamline Data<a class="headerlink" href="#beamline-data" title="Permalink to this headline">¶</a></h2>
<p>The following Electron and Photon Beam data are generally recorded for all experiments.</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [17]: </span><span class="n">evt</span><span class="o">.</span><span class="n">EBeam</span><span class="o">.</span><span class="n">show_info</span><span class="p">()</span>
<span class="gh">Out[17]:</span>
<span class="gt">--------------------------------------------------------------------------------</span>
<span class="n">EBeam</span> <span class="n">xpptut15</span><span class="p">,</span> <span class="n">Run</span> <span class="mi">54</span><span class="p">,</span> <span class="n">Step</span> <span class="mi">0</span><span class="p">,</span> <span class="n">Event</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">11</span><span class="p">:</span><span class="mi">37</span><span class="p">:</span><span class="mf">12.4768</span><span class="p">,</span> <span class="p">[</span><span class="mi">140</span><span class="p">,</span> <span class="mi">40</span><span class="p">]</span>
<span class="gt">--------------------------------------------------------------------------------</span>
<span class="n">damageMask</span>                    <span class="mi">1048574</span>         <span class="n">Damage</span> <span class="n">mask</span><span class="o">.</span>
<span class="n">ebeamCharge</span>                <span class="mf">0.00088572</span> <span class="n">nC</span>      <span class="n">Beam</span> <span class="n">charge</span> <span class="ow">in</span> <span class="n">nC</span><span class="o">.</span>
<span class="n">ebeamDumpCharge</span>                     <span class="mi">0</span> <span class="n">e</span><span class="o">-</span>      <span class="n">Bunch</span> <span class="n">charge</span> <span class="n">at</span> <span class="n">Dump</span> <span class="ow">in</span> <span class="n">num</span><span class="o">.</span> <span class="n">electrons</span>
<span class="n">ebeamEnergyBC1</span>                <span class="o">-</span><span class="mf">13.772</span> <span class="n">mm</span>      <span class="n">Beam</span> <span class="n">position</span> <span class="ow">in</span> <span class="n">mm</span> <span class="p">(</span><span class="n">related</span> <span class="n">to</span> <span class="n">beam</span> <span class="n">energy</span><span class="p">)</span><span class="o">.</span>
<span class="n">ebeamEnergyBC2</span>               <span class="o">-</span><span class="mf">0.38553</span> <span class="n">mm</span>      <span class="n">Beam</span> <span class="n">position</span> <span class="ow">in</span> <span class="n">mm</span> <span class="p">(</span><span class="n">related</span> <span class="n">to</span> <span class="n">beam</span> <span class="n">energy</span><span class="p">)</span><span class="o">.</span>
<span class="n">ebeamL3Energy</span>                       <span class="mi">0</span> <span class="n">MeV</span>     <span class="n">Beam</span> <span class="n">energy</span> <span class="ow">in</span> <span class="n">MeV</span><span class="o">.</span>
<span class="n">ebeamLTU250</span>                         <span class="mi">0</span> <span class="n">mm</span>      <span class="n">LTU250</span> <span class="n">BPM</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">mm</span><span class="p">,</span> <span class="n">used</span> <span class="n">to</span> <span class="n">compute</span> <span class="n">photon</span> <span class="n">energy</span><span class="o">.</span> <span class="kn">from</span> <span class="nn">BPMS</span><span class="p">:</span><span class="n">LTU1</span><span class="p">:</span><span class="mi">250</span><span class="p">:</span><span class="n">X</span>
<span class="n">ebeamLTU450</span>                         <span class="mi">0</span> <span class="n">mm</span>      <span class="n">LTU450</span> <span class="n">BPM</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">mm</span><span class="p">,</span> <span class="n">used</span> <span class="n">to</span> <span class="n">compute</span> <span class="n">photon</span> <span class="n">energy</span><span class="o">.</span> <span class="kn">from</span> <span class="nn">BPMS</span><span class="p">:</span><span class="n">LTU1</span><span class="p">:</span><span class="mi">450</span><span class="p">:</span><span class="n">X</span>
<span class="n">ebeamLTUAngX</span>                        <span class="mi">0</span> <span class="n">mrad</span>    <span class="n">LTU</span> <span class="n">beam</span> <span class="n">angle</span> <span class="ow">in</span> <span class="n">mrad</span><span class="o">.</span>
<span class="n">ebeamLTUAngY</span>                        <span class="mi">0</span> <span class="n">mrad</span>    <span class="n">LTU</span> <span class="n">beam</span> <span class="n">angle</span> <span class="ow">in</span> <span class="n">mrad</span><span class="o">.</span>
<span class="n">ebeamLTUPosX</span>                        <span class="mi">0</span> <span class="n">mm</span>      <span class="n">LTU</span> <span class="n">beam</span> <span class="n">position</span> <span class="p">(</span><span class="n">BPMS</span><span class="p">:</span><span class="n">LTU1</span><span class="p">:</span><span class="mi">720</span> <span class="n">through</span> <span class="mi">750</span><span class="p">)</span> <span class="ow">in</span> <span class="n">mm</span><span class="o">.</span>
<span class="n">ebeamLTUPosY</span>                        <span class="mi">0</span> <span class="n">mm</span>      <span class="n">LTU</span> <span class="n">beam</span> <span class="n">position</span> <span class="ow">in</span> <span class="n">mm</span><span class="o">.</span>
<span class="n">ebeamPhotonEnergy</span>                   <span class="mi">0</span> <span class="n">eV</span>      <span class="n">computed</span> <span class="n">photon</span> <span class="n">energy</span><span class="p">,</span> <span class="ow">in</span> <span class="n">eV</span>
<span class="n">ebeamPkCurrBC1</span>                 <span class="mf">33.661</span> <span class="n">Amps</span>    <span class="n">Beam</span> <span class="n">current</span> <span class="ow">in</span> <span class="n">Amps</span><span class="o">.</span>
<span class="n">ebeamPkCurrBC2</span>             <span class="mf">7.1578e+08</span> <span class="n">Amps</span>    <span class="n">Beam</span> <span class="n">current</span> <span class="ow">in</span> <span class="n">Amps</span><span class="o">.</span>
<span class="n">ebeamUndAngX</span>                        <span class="mi">0</span> <span class="n">mrad</span>    <span class="n">Undulator</span> <span class="n">launch</span> <span class="n">feedback</span> <span class="n">beam</span> <span class="n">x</span><span class="o">-</span><span class="n">angle</span> <span class="ow">in</span> <span class="n">mrad</span><span class="o">.</span>
<span class="n">ebeamUndAngY</span>                        <span class="mi">0</span> <span class="n">mrad</span>    <span class="n">Undulator</span> <span class="n">launch</span> <span class="n">feedback</span> <span class="n">beam</span> <span class="n">y</span><span class="o">-</span><span class="n">angle</span> <span class="ow">in</span> <span class="n">mrad</span><span class="o">.</span>
<span class="n">ebeamUndPosX</span>                        <span class="mi">0</span> <span class="n">mm</span>      <span class="n">Undulator</span> <span class="n">launch</span> <span class="n">feedback</span> <span class="p">(</span><span class="n">BPMs</span> <span class="n">U4</span> <span class="n">through</span> <span class="n">U10</span><span class="p">)</span> <span class="n">beam</span> <span class="n">x</span><span class="o">-</span><span class="n">position</span> <span class="ow">in</span> <span class="n">mm</span><span class="o">.</span>
<span class="n">ebeamUndPosY</span>                        <span class="mi">0</span> <span class="n">mm</span>      <span class="n">Undulator</span> <span class="n">launch</span> <span class="n">feedback</span> <span class="n">beam</span> <span class="n">y</span><span class="o">-</span><span class="n">position</span> <span class="ow">in</span> <span class="n">mm</span><span class="o">.</span>
<span class="n">ebeamXTCAVAmpl</span>                      <span class="mi">0</span> <span class="n">MVolt</span>   <span class="n">XTCAV</span> <span class="n">Amplitude</span> <span class="ow">in</span> <span class="n">MVolt</span><span class="o">.</span>
<span class="n">ebeamXTCAVPhase</span>                     <span class="mi">0</span> <span class="n">degrees</span> <span class="n">XTCAV</span> <span class="n">Phase</span> <span class="ow">in</span> <span class="n">degrees</span><span class="o">.</span>

<span class="gp">In [18]: </span><span class="n">evt</span><span class="o">.</span><span class="n">FEEGasDetEnergy</span><span class="o">.</span><span class="n">show_info</span><span class="p">()</span>
<span class="gh">Out[18]:</span>
<span class="gt">--------------------------------------------------------------------------------</span>
<span class="n">FEEGasDetEnergy</span> <span class="n">xpptut15</span><span class="p">,</span> <span class="n">Run</span> <span class="mi">54</span><span class="p">,</span> <span class="n">Step</span> <span class="mi">0</span><span class="p">,</span> <span class="n">Event</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">11</span><span class="p">:</span><span class="mi">37</span><span class="p">:</span><span class="mf">12.4768</span><span class="p">,</span> <span class="p">[</span><span class="mi">140</span><span class="p">,</span> <span class="mi">40</span><span class="p">]</span>
<span class="gt">--------------------------------------------------------------------------------</span>
<span class="n">f_11_ENRC</span>                      <span class="mf">3.3573</span> <span class="n">mJ</span>      <span class="n">First</span> <span class="n">energy</span> <span class="n">measurement</span> <span class="p">(</span><span class="n">mJ</span><span class="p">)</span> <span class="n">before</span> <span class="n">attenuation</span><span class="o">.</span> <span class="p">(</span><span class="n">pv</span> <span class="n">name</span> <span class="n">GDET</span><span class="p">:</span><span class="n">FEE1</span><span class="p">:</span><span class="mi">241</span><span class="p">:</span><span class="n">ENRC</span><span class="p">)</span>
<span class="n">f_12_ENRC</span>                  <span class="o">-</span><span class="mf">0.0015399</span> <span class="n">mJ</span>      <span class="n">Second</span> <span class="p">(</span><span class="n">duplicate</span><span class="o">!)</span> energy measurement <span class="o">(</span>mJ<span class="o">)</span> after attenuation. <span class="o">(</span>pv name GDET:FEE1:242:ENRC<span class="o">)</span>
<span class="n">f_21_ENRC</span>                  <span class="o">-</span><span class="mf">0.0026742</span> <span class="n">mJ</span>      <span class="n">First</span> <span class="n">energy</span> <span class="n">measurement</span> <span class="p">(</span><span class="n">mJ</span><span class="p">)</span> <span class="n">after</span> <span class="n">attenuation</span><span class="o">.</span> <span class="p">(</span><span class="n">pv</span> <span class="n">name</span>  <span class="n">GDET</span><span class="p">:</span><span class="n">FEE1</span><span class="p">:</span><span class="mi">361</span><span class="p">:</span><span class="n">ENRC</span><span class="p">)</span>
<span class="n">f_22_ENRC</span>                   <span class="mf">0.0009475</span> <span class="n">mJ</span>      <span class="n">Second</span> <span class="p">(</span><span class="n">duplicate</span><span class="o">!)</span> energy measurement <span class="o">(</span>mJ<span class="o">)</span> after attenuation. <span class="o">(</span>pv name GDET:FEE1:362:ENRC<span class="o">)</span>
<span class="n">f_63_ENRC</span>                   <span class="o">-</span><span class="mf">0.012089</span> <span class="n">mJ</span>      <span class="n">First</span> <span class="n">energy</span> <span class="n">measurement</span> <span class="p">(</span><span class="n">mJ</span><span class="p">)</span> <span class="k">for</span> <span class="n">small</span> <span class="n">signals</span> <span class="p">(</span><span class="o">&lt;</span><span class="mf">0.5</span> <span class="n">mJ</span><span class="p">),</span> <span class="n">after</span> <span class="n">attenuation</span><span class="o">.</span> <span class="p">(</span><span class="n">pv</span> <span class="n">name</span> <span class="n">GDET</span><span class="p">:</span><span class="n">FEE1</span><span class="p">:</span><span class="mi">363</span><span class="p">:</span><span class="n">ENRC</span><span class="p">)</span>
<span class="n">f_64_ENRC</span>                  <span class="o">-</span><span class="mf">0.0032068</span> <span class="n">mJ</span>      <span class="n">Second</span> <span class="p">(</span><span class="n">duplicate</span><span class="o">!)</span> energy measurement <span class="o">(</span>mJ<span class="o">)</span> <span class="k">for</span> small signals <span class="o">(</span>&lt;0.5mJ<span class="o">)</span>, after attenutation. <span class="o">(</span>pv name GDET:FEE1:364:ENRC<span class="o">)</span>

<span class="gp">In [19]: </span><span class="n">evt</span><span class="o">.</span><span class="n">PhaseCavity</span><span class="o">.</span><span class="n">show_info</span><span class="p">()</span>
<span class="gh">Out[19]:</span>
<span class="gt">--------------------------------------------------------------------------------</span>
<span class="n">PhaseCavity</span> <span class="n">xpptut15</span><span class="p">,</span> <span class="n">Run</span> <span class="mi">54</span><span class="p">,</span> <span class="n">Step</span> <span class="mi">0</span><span class="p">,</span> <span class="n">Event</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">11</span><span class="p">:</span><span class="mi">37</span><span class="p">:</span><span class="mf">12.4768</span><span class="p">,</span> <span class="p">[</span><span class="mi">140</span><span class="p">,</span> <span class="mi">40</span><span class="p">]</span>
<span class="gt">--------------------------------------------------------------------------------</span>
<span class="n">charge1</span>                       <span class="mf">0.11027</span> <span class="n">pico</span><span class="o">-</span><span class="n">columbs</span> <span class="n">UND</span><span class="p">:</span><span class="n">R02</span><span class="p">:</span><span class="n">IOC</span><span class="p">:</span><span class="mi">16</span><span class="p">:</span><span class="n">BAT</span><span class="p">:</span><span class="n">Charge1</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">pico</span><span class="o">-</span><span class="n">columbs</span><span class="o">.</span>
<span class="n">charge2</span>                       <span class="mf">0.13702</span> <span class="n">pico</span><span class="o">-</span><span class="n">columbs</span> <span class="n">UND</span><span class="p">:</span><span class="n">R02</span><span class="p">:</span><span class="n">IOC</span><span class="p">:</span><span class="mi">16</span><span class="p">:</span><span class="n">BAT</span><span class="p">:</span><span class="n">Charge2</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">pico</span><span class="o">-</span><span class="n">columbs</span><span class="o">.</span>
<span class="n">fitTime1</span>                       <span class="mf">70.333</span> <span class="n">pico</span><span class="o">-</span><span class="n">seconds</span> <span class="n">UND</span><span class="p">:</span><span class="n">R02</span><span class="p">:</span><span class="n">IOC</span><span class="p">:</span><span class="mi">16</span><span class="p">:</span><span class="n">BAT</span><span class="p">:</span><span class="n">FitTime1</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">pico</span><span class="o">-</span><span class="n">seconds</span><span class="o">.</span>
<span class="n">fitTime2</span>                     <span class="o">-</span><span class="mf">0.31647</span> <span class="n">pico</span><span class="o">-</span><span class="n">seconds</span> <span class="n">UND</span><span class="p">:</span><span class="n">R02</span><span class="p">:</span><span class="n">IOC</span><span class="p">:</span><span class="mi">16</span><span class="p">:</span><span class="n">BAT</span><span class="p">:</span><span class="n">FitTime2</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">pico</span><span class="o">-</span><span class="n">seconds</span><span class="o">.</span>
</pre></div>
</div>
</div>
<div class="section" id="epics-data">
<h2>Epics Data<a class="headerlink" href="#epics-data" title="Permalink to this headline">¶</a></h2>
<p>The LCLS DAQ includes many slowly changing quantities (e.g. voltages, temperatures, motor positions) that are recorded with software called EPICS.  These can either be accessed by aliases or PV name.</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [26]: </span><span class="n">ds</span> <span class="o">=</span> <span class="n">PyDataSource</span><span class="o">.</span><span class="n">DataSource</span><span class="p">(</span><span class="n">exp</span><span class="o">=</span><span class="s1">&#39;xpptut15&#39;</span><span class="p">,</span><span class="n">run</span><span class="o">=</span><span class="mi">59</span><span class="p">)</span>

<span class="gp">In [26]: </span><span class="n">evt</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">events</span><span class="o">.</span><span class="n">next</span><span class="p">()</span>

<span class="gp">In [27]: </span><span class="n">ds</span><span class="o">.</span><span class="n">epicsData</span><span class="o">.</span>
<span class="go">              ds.epicsData.alias        ds.epicsData.ccm          ds.epicsData.CSPAD        ds.epicsData.filt         ds.epicsData.hrm1         ds.epicsData.ipm1</span>
<span class="go">              ds.epicsData.aliases      ds.epicsData.ccmE         ds.epicsData.drift        ds.epicsData.FS3          ds.epicsData.hrm2         ds.epicsData.ipm1b</span>
<span class="go">              ds.epicsData.alio         ds.epicsData.ccmTheta0    ds.epicsData.epicsConfig  ds.epicsData.getPV        ds.epicsData.HX2          ds.epicsData.ipm2         &gt;</span>
<span class="go">              ds.epicsData.analogOut    ds.epicsData.ChipAddress  ds.epicsData.EVR          ds.epicsData.gon          ds.epicsData.HX3          ds.epicsData.ipm3</span>
<span class="go">              ds.epicsData.Be           ds.epicsData.ChipName     ds.epicsData.FeeAtt       ds.epicsData.grid         ds.epicsData.ipm          ds.epicsData.ire</span>

<span class="gp">In [27]: </span><span class="n">ds</span><span class="o">.</span><span class="n">epicsData</span><span class="o">.</span><span class="n">SampleTemp</span><span class="o">.</span><span class="n">show_info</span><span class="p">()</span>
<span class="gh">Out[27]:</span>
<span class="go">SampleTemp_GetA                         480 -- XPP:USR:TCT:01:GET_TEMP_A</span>
<span class="go">SampleTemp_GetB                         480 -- XPP:USR:TCT:01:GET_TEMP_B</span>
<span class="go">SampleTemp_GetC                       189.5 -- XPP:USR:TCT:01:GET_TEMP_C</span>
<span class="go">SampleTemp_GetD                        3.15 -- XPP:USR:TCT:01:GET_TEMP_D</span>
<span class="go">SampleTemp_Set                           20 -- XPP:USR:TCT:01:PUT_SOLL_1</span>
<span class="go">SampleTemp_SetRB                         20 -- XPP:USR:TCT:01:GET_SOLL_1</span>

<span class="gp">In [28]: </span><span class="n">ds</span><span class="o">.</span><span class="n">epicsData</span><span class="o">.</span><span class="n">SampleTemp</span><span class="o">.</span><span class="n">GetA</span><span class="o">.</span><span class="n">value</span>
<span class="gh">Out[28]: </span><span class="go">480.0</span>
</pre></div>
</div>
<p>Epics data associated with detectors (using the convention of using an alias starting with the detector name) can be accessed either from the ds.epicsData object or more conveniently from the epicsData object in the detector.</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [28]: </span><span class="n">ds</span><span class="o">.</span><span class="n">epicsData</span><span class="o">.</span><span class="n">yag2</span><span class="o">.</span><span class="n">show_info</span><span class="p">()</span>
<span class="gh">Out[28]:</span>
<span class="go">yag2_focus                           -1.151 -- XPP:SB3:CLF:01.RBV</span>
<span class="go">yag2_zoom                                65 -- XPP:SB3:CLZ:01.RBV</span>

<span class="gp">In [29]: </span><span class="n">evt</span><span class="o">.</span><span class="n">yag2</span><span class="o">.</span><span class="n">epicsData</span><span class="o">.</span><span class="n">show_info</span><span class="p">()</span>
<span class="gh">Out[29]:</span>
<span class="go">yag2_focus                           -1.151 -- XPP:SB3:CLF:01.RBV</span>
<span class="go">yag2_zoom                                65 -- XPP:SB3:CLZ:01.RBV</span>
</pre></div>
</div>
</div>
<div class="section" id="waveform-detectors">
<h2>Waveform Detectors<a class="headerlink" href="#waveform-detectors" title="Permalink to this headline">¶</a></h2>
<dl class="docutils">
<dt>There are several types of voltage-versus-time (&#8220;waveform&#8221;) detectors supported:</dt>
<dd><ul class="first last simple">
<li>Acqiris (now &#8220;Agilent U1065A&#8221;)</li>
<li>&#8216;Imp&#8217; detectors (SLAC).</li>
<li>&#8216;Wave8&#8217; detectors (SLAC).</li>
</ul>
</dd>
</dl>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">PyDataSource</span>

<span class="n">ds</span> <span class="o">=</span> <span class="n">PyDataSource</span><span class="o">.</span><span class="n">DataSource</span><span class="p">(</span><span class="n">exp</span><span class="o">=</span><span class="s1">&#39;amotut13&#39;</span><span class="p">,</span><span class="n">run</span><span class="o">=</span><span class="mi">206</span><span class="p">)</span>
<span class="n">evt</span>  <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">events</span><span class="o">.</span><span class="n">next</span><span class="p">()</span>
<span class="n">evt</span><span class="o">.</span><span class="n">AmoETOF_0_Acqiris_0</span><span class="o">.</span><span class="n">show_info</span><span class="p">()</span>
<span class="n">evt</span><span class="o">.</span><span class="n">AmoETOF_0_Acqiris_0</span><span class="o">.</span><span class="n">waveform</span><span class="o">.</span><span class="n">shape</span>

<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">evt</span><span class="o">.</span><span class="n">AmoETOF_0_Acqiris_0</span><span class="o">.</span><span class="n">wftime</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">evt</span><span class="o">.</span><span class="n">AmoETOF_0_Acqiris_0</span><span class="o">.</span><span class="n">waveform</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>(<a class="reference external" href="./examples/acqiris.py">Source code</a>, <a class="reference external" href="./examples/acqiris.png">png</a>, <a class="reference external" href="./examples/acqiris.hires.png">hires.png</a>, <a class="reference external" href="./examples/acqiris.pdf">pdf</a>)</p>
<div class="figure">
<img alt="_images/acqiris.png" src="_images/acqiris.png" />
</div>
<p>NOTE: For Acqiris detectors the user can often find between 0-7 &#8220;zeros&#8221; at the end of the arrays.  This is because the acqiris will read out 40,000 samples, for example, but the trigger is not necessarily on sample 0: from shot-to-shot it can vary between 0 and 7.</p>
<p>In the above user interface we move the data arrays so the trigger happens on sample 0 (so users can more easily add results from different events, for example). But after we do this, to keep the array sizes constant, we pad the end with zeros. This is not ideal, but it makes the user-interface simpler, which is important for LCLS users.</p>
<p>In this example we use older data that does not have aliases, so the detectors names are generated from their &#8216;daq&#8217; identifiers.</p>
</div>
<div class="section" id="anlyzing-scans">
<h2>Anlyzing Scans<a class="headerlink" href="#anlyzing-scans" title="Permalink to this headline">¶</a></h2>
<p>Information about daq scans (where things like motor positions are changed during a run in &#8220;steps&#8221; or &#8220;calibcycles&#8221;) is accessible from the ds.configData.  The ScanData object may take dozens of seconds to load the first time depending on the length of the scan.  Once loaded you have access to the scan information as lists the length of the number of steps in the scan.</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [2]: </span><span class="kn">import</span> <span class="nn">PyDataSource</span>

<span class="gp">In [3]: </span><span class="n">ds</span>  <span class="o">=</span> <span class="n">PyDataSource</span><span class="o">.</span><span class="n">DataSource</span><span class="p">(</span><span class="n">exp</span><span class="o">=</span><span class="s1">&#39;xpptut15&#39;</span><span class="p">,</span><span class="n">run</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>

<span class="gp">In [4]: </span><span class="o">%</span><span class="k">time</span> ds.configData.ScanData.show_info()
<span class="go">CPU times: user 51.7 s, sys: 2.4 s, total: 54.1 s</span>
<span class="go">Wall time: 50.5 s</span>
<span class="gh">Out[4]:</span>
<span class="go">xpptut15  : Run 200</span>
<span class="gt">----------------------------------------------------------------------</span>
<span class="n">Number</span> <span class="n">of</span> <span class="n">steps</span>                  <span class="mi">45</span> <span class="n">nsteps</span>
<span class="n">Number</span> <span class="n">of</span> <span class="n">monitor</span> <span class="n">PVs</span>             <span class="mi">0</span> <span class="n">npvMonitors</span>
<span class="n">Number</span> <span class="n">of</span> <span class="n">control</span> <span class="n">PVs</span>             <span class="mi">1</span> <span class="n">npvControls</span>

<span class="n">Alias</span>                    <span class="n">PV</span>
<span class="gt">----------------------------------------------------------------------</span>
<span class="n">lxt_vitara_ttc</span>           <span class="n">lxt_vitara_ttc</span>

<span class="n">Step</span> <span class="n">Events</span>   <span class="n">Time</span> <span class="p">[</span><span class="n">s</span><span class="p">]</span> <span class="n">lxt_vitara_ttc</span>
<span class="gt">-----------------------------------</span>
<span class="g g-Whitespace">   </span><span class="mi">0</span>   <span class="mi">1306</span>   <span class="mf">19.179</span>     <span class="o">-</span><span class="mf">1.000e-12</span>
<span class="g g-Whitespace">   </span><span class="mi">1</span>    <span class="mi">625</span>    <span class="mf">5.207</span>     <span class="o">-</span><span class="mf">7.500e-13</span>
<span class="g g-Whitespace">   </span><span class="mi">2</span>    <span class="mi">629</span>    <span class="mf">5.239</span>     <span class="o">-</span><span class="mf">5.000e-13</span>
<span class="g g-Whitespace">   </span><span class="mi">3</span>    <span class="mi">635</span>    <span class="mf">5.289</span>     <span class="o">-</span><span class="mf">2.500e-13</span>
<span class="g g-Whitespace">   </span><span class="mi">4</span>    <span class="mi">635</span>    <span class="mf">5.289</span>     <span class="o">-</span><span class="mf">8.470e-22</span>
<span class="g g-Whitespace">   </span><span class="mi">5</span>   <span class="mi">3413</span>   <span class="mf">37.788</span>      <span class="mf">2.500e-13</span>
<span class="g g-Whitespace">   </span><span class="mi">6</span>    <span class="mi">623</span>    <span class="mf">5.190</span>      <span class="mf">5.000e-13</span>
<span class="g g-Whitespace">   </span><span class="mi">7</span>    <span class="mi">629</span>    <span class="mf">5.240</span>      <span class="mf">7.500e-13</span>
<span class="g g-Whitespace">   </span><span class="mi">8</span>    <span class="mi">629</span>    <span class="mf">5.240</span>      <span class="mf">1.000e-12</span>
<span class="g g-Whitespace">   </span><span class="mi">9</span>    <span class="mi">629</span>    <span class="mf">5.241</span>      <span class="mf">1.250e-12</span>
<span class="g g-Whitespace">  </span><span class="mi">10</span>    <span class="mi">635</span>    <span class="mf">5.290</span>      <span class="mf">1.500e-12</span>
<span class="g g-Whitespace">  </span><span class="mi">11</span>    <span class="mi">635</span>    <span class="mf">5.291</span>      <span class="mf">1.750e-12</span>
<span class="g g-Whitespace">  </span><span class="mi">12</span>    <span class="mi">635</span>    <span class="mf">5.291</span>      <span class="mf">2.000e-12</span>
<span class="g g-Whitespace">  </span><span class="mi">13</span>    <span class="mi">629</span>    <span class="mf">5.241</span>      <span class="mf">2.250e-12</span>
<span class="g g-Whitespace">  </span><span class="mi">14</span>   <span class="mi">1487</span>   <span class="mf">17.988</span>      <span class="mf">2.500e-12</span>
<span class="g g-Whitespace">  </span><span class="mi">15</span>    <span class="mi">623</span>    <span class="mf">5.190</span>      <span class="mf">2.750e-12</span>
<span class="g g-Whitespace">  </span><span class="mi">16</span>    <span class="mi">623</span>    <span class="mf">5.189</span>      <span class="mf">3.000e-12</span>
<span class="g g-Whitespace">  </span><span class="mi">17</span>    <span class="mi">623</span>    <span class="mf">5.190</span>      <span class="mf">3.250e-12</span>
<span class="g g-Whitespace">  </span><span class="mi">18</span>    <span class="mi">629</span>    <span class="mf">5.240</span>      <span class="mf">3.500e-12</span>
<span class="g g-Whitespace">  </span><span class="mi">19</span>    <span class="mi">629</span>    <span class="mf">5.240</span>      <span class="mf">3.750e-12</span>
<span class="g g-Whitespace">  </span><span class="mi">20</span>    <span class="mi">637</span>    <span class="mf">5.306</span>      <span class="mf">4.000e-12</span>
<span class="g g-Whitespace">  </span><span class="mi">21</span>    <span class="mi">629</span>    <span class="mf">5.240</span>      <span class="mf">4.250e-12</span>
<span class="g g-Whitespace">  </span><span class="mi">22</span>    <span class="mi">777</span>    <span class="mf">6.473</span>      <span class="mf">4.500e-12</span>
<span class="g g-Whitespace">  </span><span class="mi">23</span>    <span class="mi">629</span>    <span class="mf">5.240</span>      <span class="mf">4.750e-12</span>
<span class="g g-Whitespace">  </span><span class="mi">24</span>    <span class="mi">629</span>    <span class="mf">5.240</span>      <span class="mf">5.000e-12</span>
<span class="g g-Whitespace">  </span><span class="mi">25</span>    <span class="mi">629</span>    <span class="mf">5.240</span>      <span class="mf">5.250e-12</span>
<span class="g g-Whitespace">  </span><span class="mi">26</span>    <span class="mi">629</span>    <span class="mf">5.240</span>      <span class="mf">5.500e-12</span>
<span class="g g-Whitespace">  </span><span class="mi">27</span>    <span class="mi">629</span>    <span class="mf">5.239</span>      <span class="mf">5.750e-12</span>
<span class="g g-Whitespace">  </span><span class="mi">28</span>    <span class="mi">629</span>    <span class="mf">5.239</span>      <span class="mf">6.000e-12</span>
<span class="g g-Whitespace">  </span><span class="mi">29</span>    <span class="mi">629</span>    <span class="mf">5.240</span>      <span class="mf">6.250e-12</span>
<span class="g g-Whitespace">  </span><span class="mi">30</span>    <span class="mi">629</span>    <span class="mf">5.241</span>      <span class="mf">6.500e-12</span>
<span class="g g-Whitespace">  </span><span class="mi">31</span>    <span class="mi">629</span>    <span class="mf">5.241</span>      <span class="mf">6.750e-12</span>
<span class="g g-Whitespace">  </span><span class="mi">32</span>    <span class="mi">623</span>    <span class="mf">5.191</span>      <span class="mf">7.000e-12</span>
<span class="g g-Whitespace">  </span><span class="mi">33</span>    <span class="mi">629</span>    <span class="mf">5.240</span>      <span class="mf">7.250e-12</span>
<span class="g g-Whitespace">  </span><span class="mi">34</span>    <span class="mi">623</span>    <span class="mf">5.191</span>      <span class="mf">7.500e-12</span>
<span class="g g-Whitespace">  </span><span class="mi">35</span>   <span class="mi">1361</span>   <span class="mf">11.340</span>      <span class="mf">7.750e-12</span>
<span class="g g-Whitespace">  </span><span class="mi">36</span>    <span class="mi">767</span>    <span class="mf">6.388</span>      <span class="mf">8.000e-12</span>
<span class="g g-Whitespace">  </span><span class="mi">37</span>    <span class="mi">899</span>    <span class="mf">7.488</span>      <span class="mf">8.250e-12</span>
<span class="g g-Whitespace">  </span><span class="mi">38</span>   <span class="mi">1037</span>    <span class="mf">8.640</span>      <span class="mf">8.500e-12</span>
<span class="g g-Whitespace">  </span><span class="mi">39</span>    <span class="mi">629</span>    <span class="mf">5.240</span>      <span class="mf">8.750e-12</span>
<span class="g g-Whitespace">  </span><span class="mi">40</span>    <span class="mi">629</span>    <span class="mf">5.240</span>      <span class="mf">9.000e-12</span>
<span class="g g-Whitespace">  </span><span class="mi">41</span>    <span class="mi">623</span>    <span class="mf">5.190</span>      <span class="mf">9.250e-12</span>
<span class="g g-Whitespace">  </span><span class="mi">42</span>    <span class="mi">623</span>    <span class="mf">5.190</span>      <span class="mf">9.500e-12</span>
<span class="g g-Whitespace">  </span><span class="mi">43</span>    <span class="mi">629</span>    <span class="mf">5.240</span>      <span class="mf">9.750e-12</span>
<span class="g g-Whitespace">  </span><span class="mi">44</span>    <span class="mi">629</span>    <span class="mf">5.241</span>      <span class="mf">1.000e-11</span>

<span class="gp">In [5]: </span> <span class="n">ds</span><span class="o">.</span><span class="n">configData</span><span class="o">.</span><span class="n">ScanData</span><span class="o">.</span><span class="n">control_values</span>
<span class="go">                 ds.configData.ScanData.control_values   ds.configData.ScanData.nevents</span>
<span class="go">                 ds.configData.ScanData.end_times        ds.configData.ScanData.npvControls</span>
<span class="go">                 ds.configData.ScanData.lxt_vitara_ttc   ds.configData.ScanData.npvMonitors      &gt;</span>
<span class="go">                 ds.configData.ScanData.monitor_hivalues ds.configData.ScanData.nsteps</span>
<span class="go">                 ds.configData.ScanData.monitor_lovalues ds.configData.ScanData.pvAliases</span>
</pre></div>
</div>
<p>Here is a quick way to iterate over steps:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [6]: </span> <span class="k">for</span> <span class="n">istep</span><span class="p">,</span> <span class="n">stepevts</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">ds</span><span class="o">.</span><span class="n">steps</span><span class="p">):</span>
<span class="go">    ...:     evt = stepevts.next()</span>
<span class="go">    ...:     print istep, evt</span>
<span class="go">    ...:</span>
<span class="go">0 xpptut15, Run 200, Step 0, Event 0, 07:17:55.8309, [141, 90, 40, 41, 140]</span>
<span class="go">1 xpptut15, Run 200, Step 1, Event 0, 07:18:17.5429, [141, 142, 91, 40, 41, 42, 140]</span>
<span class="go">2 xpptut15, Run 200, Step 2, Event 0, 07:18:25.0651, [90, 40, 140]</span>
<span class="go">3 xpptut15, Run 200, Step 3, Event 0, 07:18:32.9365, [60, 141, 142, 91, 40, 41, 42, 140]</span>
<span class="go">4 xpptut15, Run 200, Step 4, Event 0, 07:18:40.8244, [90, 40, 140]</span>
<span class="go">...</span>
</pre></div>
</div>
</div>
<div class="section" id="reloading-datasource">
<h2>Reloading DataSource<a class="headerlink" href="#reloading-datasource" title="Permalink to this headline">¶</a></h2>
<p>Use the reload method to start back at the beginning of a run.</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [64]: </span><span class="n">ds</span><span class="o">.</span><span class="n">reload</span><span class="p">()</span>

<span class="gp">In [65]: </span><span class="n">evt</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">events</span><span class="o">.</span><span class="n">next</span><span class="p">()</span>

<span class="gp">In [66]: </span><span class="n">evt</span>
<span class="gh">Out[66]: </span><span class="go">&lt; EvtDetectors: xpptut15, Run 200, Step 0, Event 0, 07:17:55.8309, [141, 90, 40, 41, 140] &gt;</span>

<span class="gp">In [67]: </span><span class="n">evt</span><span class="o">.</span><span class="n">next</span><span class="p">()</span>
<span class="gh">Out[67]: </span><span class="go">&lt; EvtDetectors: xpptut15, Run 200, Step 0, Event 1, 07:17:55.8392, [50, 51, 60, 61, 90, 40, 140] &gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="jump-quickly-to-specific-event">
<h2>Jump Quickly to Specific Event<a class="headerlink" href="#jump-quickly-to-specific-event" title="Permalink to this headline">¶</a></h2>
<p>Time stamps can be used to jump to specific event in the next method.  Alternatively an interger event number can be supplied to goto event number in DataSource (although it may not be exactly same event depending on how the data_source string is corresponding keywords to define the data_source is defined and also may differ for fast feedback and offline analysis environments).</p>
<p>This example shows jumping to event 200, saving the EventTime, going back to event 0, and then using the saved EventTime to jump back to event 200.</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [67]: </span><span class="n">evt</span><span class="o">.</span><span class="n">next</span><span class="p">()</span>
<span class="gh">Out[67]: </span><span class="go">&lt; EvtDetectors: xpptut15, Run 200, Step 0, Event 1, 07:17:55.8392, [50, 51, 60, 61, 90, 40, 140] &gt;</span>

<span class="gp">In [68]: </span><span class="n">evt</span><span class="o">.</span><span class="n">next</span><span class="p">(</span><span class="mi">200</span><span class="p">)</span>
<span class="gh">Out[68]: </span><span class="go">&lt; EvtDetectors: xpptut15, Run 200, Step -1, Event 200, 07:17:57.4975, [50, 60, 141, 90, 40, 41, 140] &gt;</span>

<span class="gp">In [69]: </span><span class="n">et200</span> <span class="o">=</span> <span class="n">evt</span><span class="o">.</span><span class="n">EventId</span><span class="o">.</span><span class="n">EventTime</span>

<span class="gp">In [70]: </span><span class="n">evt</span><span class="o">.</span><span class="n">next</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gh">Out[70]: </span><span class="go">&lt; EvtDetectors: xpptut15, Run 200, Step -1, Event 0, 07:17:55.8309, [141, 90, 40, 41, 140] &gt;</span>

<span class="gp">In [71]: </span><span class="n">evt</span><span class="o">.</span><span class="n">next</span><span class="p">(</span><span class="n">et200</span><span class="p">)</span>
<span class="gh">Out[71]: </span><span class="go">&lt; EvtDetectors: xpptut15, Run 200, Step -1, Event 200, 07:17:57.4975, [50, 60, 141, 90, 40, 41, 140] &gt;</span>
</pre></div>
</div>
<p>If nothing is passed in the next method, then the next event goes to the next event before we started jumping to specific events.</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [72]: </span><span class="n">evt</span><span class="o">.</span><span class="n">next</span><span class="p">()</span>
<span class="gh">Out[72]: </span><span class="go">&lt; EvtDetectors: xpptut15, Run 200, Step 0, Event 2, 07:17:55.8476, [50, 60, 141, 142, 90, 40, 41, 42, 140] &gt;</span>
</pre></div>
</div>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="data_processing.html" class="btn btn-neutral float-right" title="Data Processing" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="index.html" class="btn btn-neutral" title="Welcome to PyDataSource’s documentation!" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, SLAC National Accelerator Laboratory.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'0.0.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>